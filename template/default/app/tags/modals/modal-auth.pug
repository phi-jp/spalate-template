modal-auth(spat-animation='bottom')
  div.s-full.f.flex-column.bg-white.relative(ref='modal')
    form.container.p64(onsubmit='{authByEmail}')
      h2.text-center.fs16.mb64 続けるにはアカウントが必要です

      div.sns.f.fh.mb16
        div(each='{sns in snses}')
          div.s50.circle.mx8.f.fh(class='bg-{sns.id}', onclick='{authBySNS}')
            img(src='/static/images/sns/{sns.id}.svg')

      div.f.fh.mb32
        div.w-full.h1.bg-gray
        div.mx16 or
        div.w-full.h1.bg-gray

      div.mb32
        input.border-bottom.w-full.px2.py8.mb16(ref='email', type='email', placeholder='メールアドレス')
        input.border-bottom.w-full.px2.py8.mb16(ref='password', type='password', placeholder='パスワード')
        button.button.primary.w-full.py14 アカウント登録

      div
        p.fs12 登録することで、あなたは利用規約に同意し、プライバシーポリシーを熟読して理解したものとみなされます。
    div.absolute.p16.t0.r0.cursor-pointer(onclick='{close}')
      i.material-icons close
  
  style(type='less').
    :scope {
      display: block;
    }

  script.
    this.mode = 'signup';

    this.snses = [
      { id: 'twitter', provider: 'twitter.com' },
      { id: 'facebook', provider: 'facebook.com' },
      { id: 'google', provider: 'google.com' },
    ];

    this.authBySNS = async (e) => {
      e.preventDefault();

      var i = spat.modal.indicator();

      try {
        var data = await flarebase.auth.signInWithProvider(e.item.sns.provider);
        console.log(data);
        spat.modal.alert('SNS ログインに成功!');
      }
      catch (error) {
        spat.modal.alert(error.error_message);
      }
      finally {
        i.close();
      }
    };

    this.authByEmail = async (e) => {
      e.preventDefault();

      try {
        var res = await flarebase.auth.createUserWithEmailAndPassword(this.refs.email.value, this.refs.password.value);
        spat.modal.alert('メアド登録に成功!');
      }
      catch(error) {
        spat.modal.alert(error.error_message);
      }
    };
